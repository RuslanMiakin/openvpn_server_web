# Веб-интерфейс для OpenVPN

Простой PHP-интерфейс для управления OpenVPN сервером, установленным с помощью [скрипта angristan/openvpn-install](https://github.com/angristan/openvpn-install).

## Особенности

- **Управление пользователями**
  - Добавление новых пользователей с возможностью защиты конфигурации паролем
  - Удаление существующих пользователей
  - Просмотр списка всех пользователей
  - Скачивание .ovpn файлов конфигурации

- **Мониторинг подключений**
  - Отображение активных подключений
  - Информация о подключенных пользователях (IP, время подключения)

- **Статистика**
  - Общее количество пользователей и активных соединений
  - Статус работы сервера
  - Нагрузка на сервер
  - Статистика использования трафика

## Структура файлов

- `index.php` - Основная страница управления
- `functions.php` - Функции для взаимодействия с OpenVPN
- `login.php` - Страница входа в панель управления
- `download.php` - Скрипт для скачивания .ovpn файлов
- `stats.php` - Детальная статистика использования VPN
- `style.css` - Стили для всех страниц
- `.htaccess` - Настройки безопасности веб-сервера

## Установка

1. Установите и настройте OpenVPN с помощью скрипта openvpn-install.sh:
```bash
chmod +x openvpn-install.sh
sudo ./openvpn-install.sh
```

2. Установите веб-сервер и PHP:
```bash
# Для Debian/Ubuntu
sudo apt update
sudo apt install apache2 php php-cli

# Для CentOS/RHEL
sudo yum install httpd php
sudo systemctl start httpd
sudo systemctl enable httpd
```

3. Скопируйте файлы веб-интерфейса в директорию веб-сервера:
```bash
sudo cp -r web/* /var/www/html/
```

4. Настройте пути в файле functions.php:
```php
// Путь к скрипту OpenVPN 
$script_path = '/path/to/openvpn-install.sh';
```

5. Настройте права доступа:
```bash
# Дайте пользователю www-data права на запуск скрипта
echo "www-data ALL=(ALL) NOPASSWD: /path/to/openvpn-install.sh" | sudo tee -a /etc/sudoers.d/openvpn-web
chmod 440 /etc/sudoers.d/openvpn-web
```

6. Настройте защиту директории с помощью .htaccess:
```bash
# Создайте файл с паролем
sudo htpasswd -c /etc/apache2/.htpasswd admin

# Укажите путь в файле .htaccess
# AuthUserFile /path/to/.htpasswd
```

7. Убедитесь, что Apache имеет доступ к файлам статуса и сертификатов OpenVPN:
```bash
# Создайте группу для доступа
sudo groupadd openvpn-web
sudo usermod -a -G openvpn-web www-data
sudo chgrp -R openvpn-web /etc/openvpn/
sudo chmod -R g+r /etc/openvpn/
sudo chmod g+r /var/log/openvpn/status.log
```

## Безопасность

Этот веб-интерфейс должен использоваться с осторожностью, так как он предоставляет доступ к управлению VPN-сервером. Рекомендуется:

1. Всегда размещать его за HTTPS
2. Использовать строгие пароли для аутентификации
3. Ограничить доступ по IP-адресам, если возможно
4. Рассмотреть возможность использования двухфакторной аутентификации

## Настройка для продакшена

Для использования в продакшене рекомендуется:

1. Настроить HTTPS с помощью Let's Encrypt
2. Улучшить обработку ошибок и логирование
3. Использовать базу данных для хранения логов и статистики
4. Настроить регулярное резервное копирование

## Ограничения

- Текущая реализация не имеет расширенных функций мониторинга
- Ограниченные возможности конфигурирования параметров сервера
- Необходимы права sudo для выполнения скрипта OpenVPN 